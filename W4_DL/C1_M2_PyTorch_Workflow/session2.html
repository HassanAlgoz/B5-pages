<!DOCTYPE html>
<html lang="en"><head>
<link href="../../assets/icon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.26">

  <meta name="author" content="malfadly@sdaia.gov.sa">
  <title>AI Pros Bootcamp – Module 2 - Session 2: Loss Functions and Optimizers</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-2476b6dbe24137c74cb80772f2f63bf0.css">
  <link rel="stylesheet" href="../../assets/sdaia.scss">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="icon" href="../../assets/icon.svg">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../../assets/anim.svg" data-background-opacity="0.1" class="quarto-title-block center">
  <h1 class="title">Module 2 - Session 2: Loss Functions and Optimizers</h1>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="session-2" class="title-slide slide level1 center">
<h1>Session 2</h1>

</section>
<section id="the-training-sequence" class="slide level2">
<h2>The Training Sequence</h2>
<p><strong>Three lines that make learning happen:</strong></p>
<ol type="1">
<li><strong>Measure</strong> - How wrong are we?</li>
<li><strong>Diagnose</strong> - What caused the error?</li>
<li><strong>Update</strong> - How do we fix it?</li>
</ol>
<aside class="notes">
<p>As you move through this professional certificate, you’ll see these three lines come up again and again and again during training. They’re simple to write, but a lot happens behind the scenes. PyTorch will take care of the complex math for you, but in this session, you’ll take a quick look under the hood to understand what each line really does and why the order matters.</p>
<p>These three lines will work together in this sequence: Measure, Diagnose, Update. First, you’ll measure how wrong your predictions are, and that’s your loss - this one number that sums up all of your mistakes. Then, backward diagnoses the problem. It examines how each weight in your model contributed to the error, which weights made things worse, and by how much. Finally, optimizer.step updates the weights. It uses those diagnostic scores to adjust each parameter. The weights with the bigger problems will get bigger corrections.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="step-1-measuring-loss" class="slide level2">
<h2>Step 1: Measuring Loss</h2>
<p><strong>Loss function:</strong> compares predictions to true answers</p>
<p><strong>Higher number = more wrong</strong></p>
<p><strong>Goal:</strong> minimize loss</p>

<img data-src="../assets/loss_curve_training_vs_validation.png" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<p>In this session, you’re going to focus on the first step, and that’s measuring loss. You’ve already seen one kind of loss function called mean squared error, which works really well for tasks like we had when we were predicting delivery time. You’ll also meet a new loss function, cross-entropy loss, and this is used for classification problems.</p>
<p>I’ll break down how these loss functions work and how to choose the correct one for your task. Every loss function does the same basic job: it compares your model’s predictions to the true answers and then gives you a number. The higher the number, the more wrong you are.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="measuring-error-for-regression-tasks" class="slide level2">
<h2>Measuring Error for Regression Tasks</h2>
<p><strong>For regression tasks</strong> (predicting numbers): temperature, price, distance</p>
<p><strong>Average error =</strong> <span class="math inline">\(\frac{1}{n} \sum_{i=1}^n (\hat{y}_i - y_i)\)</span></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Prediction (minutes)</th>
<th>Actual (minutes)</th>
<th>Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>4</td>
<td><span class="math inline">\(6 - 4 = 2\)</span></td>
</tr>
<tr class="even">
<td>3</td>
<td>5</td>
<td><span class="math inline">\(3 - 5 = -2\)</span></td>
</tr>
</tbody>
</table>
<p><strong>Problem:</strong> Average error = 0 (mistakes cancel out!)</p>
<aside class="notes">
<p>Back in the delivery company example, you used the model to predict delivery time based on distance. Now, let’s say your model makes two predictions. The first prediction: the model predicted 6 minutes, but the actual time was 4. For the second prediction, say it predicted 3 minutes, but the actual time was 5.</p>
<p>To figure out how far off you were, you subtract the target from the prediction, and that gives you the error. It’s like measuring the distance between your guess and reality. So how wrong was your model overall? Well, loss here is the average error across all of those predictions. Think of it like a report card for your model. The lower the score, the closer your predictions are to reality on average.</p>
<p>But if you average out the raw errors - in this case it was +2 and -2, and you divide that by two because there’s two of them - you get zero. It looks like perfect performance, even though both predictions were actually wrong.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="mean-squared-error-loss" class="slide level2">
<h2>Mean Squared Error Loss</h2>
<p><strong>Squaring:</strong></p>
<ul>
<li>Gets rid of minus signs (all mistakes count)</li>
<li>Makes bigger mistakes matter more</li>
</ul>
<p><span class="math display">\[
\text{MSE} = \frac{1}{n} \sum_{i=1}^n (\hat{y}_i - y_i)^2
\]</span></p>
<aside class="notes">
<p>And this is why you use mean squared error and you square the differences. It gets rid of the minus signs. So now both mistakes count and they don’t cancel each other out. And that’s where that name comes from: mean squared error.</p>
<p>And there’s one more benefit: squaring makes bigger mistakes matter more. Being off by 10 minutes is much worse than being off by one. So MSE loss, mean squared error loss, helps in these two ways: (1) it makes sure that all mistakes count, and (2) it punishes bigger errors more than it punishes smaller ones.</p>
<p>Mean squared error is perfect when you’re predicting continuous values, things like distances, temperatures, or prices.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="cross-entropy-loss" class="slide level2">
<h2>Cross-Entropy Loss</h2>
<p><strong>For classification tasks</strong> (predicting categories): digit, animal, word</p>
<p><strong>Model outputs:</strong> confidence scores (probabilities) for each class</p>
<p><strong>All scores sum to 100%</strong></p>
<p><span class="math display">\[
\text{BCE} = -\sum_{i=1}^n y_i \log(\hat{y}_i)
\]</span></p>
<aside class="notes">
<p>But in this module, you’re tackling classification. What digit is this? And here you’re going to need a different loss function. We’ll use one called cross-entropy loss.</p>
<p>With cross-entropy loss, your model isn’t just picking an answer - it outputs a confidence score for all possible answers or classes. Take MNIST: your model must choose between digits zero through nine. So for each image, it outputs 10 numbers, a probability for each digit. This means “I’m 70% sure it’s a three, maybe 8% sure it’s a two, but it could be a zero.” And all of those scores should add up to 100%.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="how-cross-entropy-works" class="slide level2">
<h2>How Cross-Entropy Works</h2>
<p><strong>Punishes overconfident wrong answers</strong></p>
<ul>
<li>95% sure it’s a 7, but it’s actually a 3 → <strong>very high loss</strong></li>
<li>55% sure it’s a 7, but it’s actually a 3 → <strong>smaller loss</strong></li>
</ul>
<p><strong>Goal:</strong> Confident about right answers, unsure about wrong ones</p>
<aside class="notes">
<p>Now here’s the key idea: cross-entropy loss punishes overconfident wrong answers. If your model says it’s 95% sure that this is a seven, but it’s actually a three, that’s a big mistake and the loss will be very high. But if it’s only 55% sure it’s a seven, it’s still wrong, but not as confident, so the loss will be smaller.</p>
<p>You want your model to be confident about the right answers and unsure about the wrong ones. Cross-entropy loss helps shape that behavior.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="step-2-diagnosing-the-problem" class="slide level2 small">
<h2>Step 2: Diagnosing the Problem</h2>
<p><strong>Backward calculates gradients</strong></p>
<p><strong>Gradients = diagnostic scores for each parameter</strong></p>
<ul>
<li>Positive gradient → increasing weight makes loss worse</li>
<li>Negative gradient → increasing weight helps</li>
<li>Large gradient → big influence</li>
<li>Small gradient → barely mattered</li>
</ul>
<aside class="notes">
<p>In the last video, you saw how loss functions measure how right or how wrong your predictions are, and this is the first critical step in every training loop. Now let’s take a look at the next two steps.</p>
<p>After measuring how wrong your predictions are with the loss function, the next step is to figure out what caused that loss, and that’s what Backward does. Think back to how neural networks work. Each neuron takes inputs, multiplies each by a weight, adds them up with a bias, and then passes that through an activation function.</p>
<p>Even in a small neural network, you’re dealing potentially with thousands of weights and biases. So if we look at a simple example: this network has 784 inputs, 128 hidden neurons, and 10 output classes. And it has over 100,000 weights between inputs and the hidden layers. There are 128 biases for the hidden layer, and there are 1,280 weights between the hidden layer and the output. And of course there are those 10 biases for the final output layer. And that’s a total of 101,770 trainable parameters.</p>
<p>So Backward acts a little bit like a detective. It looks at every single weight and bias and asks: “How much did you contribute to the loss?” These diagnostic scores are called gradients. They tell you not just who contributed to the error, but how much and in what direction.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="what-backward-does-not-do" class="slide level2">
<h2>What Backward Does NOT Do</h2>
<p><strong>Backward does NOT update weights</strong></p>
<p><strong>It only calculates gradients</strong></p>
<p><strong>Updates happen later with <code>optimizer.step()</code></strong></p>
<aside class="notes">
<p>But here’s a common misconception: people often think that Backward updates these weights. It doesn’t. Backward only calculates gradients. It figures out how much each weight contributed to the overall loss. The actual updates will happen later when you call <code>optimizer.step()</code>.</p>
<p>You can find course resources if you want to learn more, but this course is focused on PyTorch and not Calculus. And the beauty of PyTorch is that it handles all of that complexity for you.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-gradient-descent-analogy" class="slide level2">
<h2>The Gradient Descent Analogy</h2>

<img data-src="../assets/loss_curve_for_1_parameter.png" class="r-stretch quarto-figure-center"><p class="caption">Plos: x-axis: weight, y-axis: loss</p><p><strong>Goal:</strong> minimize loss (reach bottom of valley)</p>
<p><strong>Gradient:</strong> tells you the slope (which way is downhill?)</p>
<p><strong>Go downhill → lower loss</strong></p>
<aside class="notes">
<p>But what’s really happening here? Your goal is to try to minimize loss. Think of it as like standing on a hillside trying to reach the bottom of a valley. The gradient tells you the slope at your position, which way is uphill or which way is downhill.</p>
<p>So to get to the bottom, you go in the downhill direction, and that’s going towards lower loss. And that’s why we call it gradient descent.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="zooming-in-on-a-single-parameter-taking-a-step-against-the-gradient" class="slide level2">
<h2>Zooming in on a single parameter taking a step against the gradient</h2>

<img data-src="../assets/analogy_1_parameter_descending.png" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<p>The stickman figure emphasizes two points:</p>
<ol type="1">
<li>The blind-fold on the eyes of the parameter emphasizes the fact that they can only feel the incline (slope / derivative), but cannot see further.</li>
<li>The parameter, being a stickman, moves relative to its current position by stepping. A step may be small or big, depending on the learning rate (step-size) we choose.</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="multiple-parameters" class="slide level2">
<h2>Multiple parameters</h2>
<p>If we have two parameters (<span class="math inline">\(\theta_0\)</span> and <span class="math inline">\(\theta_1\)</span>):</p>

<img data-src="../assets/analogy_2_parameter_descending.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="stochastic-gradient-descent-sgd" class="slide level2">
<h2>Stochastic Gradient Descent (SGD)</h2>
<p><strong>Strategy:</strong></p>
<ul>
<li>Negative gradient (<span class="math inline">\(\frac{\partial \text{loss}}{\partial w_0}\)</span>) → increase weight (<span class="math inline">\(w_0\)</span>)</li>
<li>Positive gradient (<span class="math inline">\(\frac{\partial \text{loss}}{\partial w_1}\)</span>) → decrease weight (<span class="math inline">\(w_1\)</span>)</li>
<li>Big gradient (<span class="math inline">\(\frac{\partial \text{loss}}{\partial w_0}\)</span>) → big change (<span class="math inline">\(w_0\)</span>)</li>
<li>Small gradient (<span class="math inline">\(\frac{\partial \text{loss}}{\partial w_1}\)</span>) → small change (<span class="math inline">\(w_1\)</span>)</li>
</ul>
<p><strong>Scales updates with learning rate</strong>: <span class="math inline">\(\text{step size} = \text{learning rate} \times \text{gradient}\)</span></p>
<aside class="notes">
<p>The simplest approach is what we’ve been using: stochastic gradient descent. SGD’s strategy is straightforward. If your weight has a negative gradient, then let’s increase it. If your weight has a positive gradient, then we can just decrease by going in the opposite direction. If it has a big gradient, we’ll make a big change. If it has a small gradient, we’ll make a small change.</p>
<p>But it doesn’t just subtract the gradient directly - it scales it first using the learning rate.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="learning-rate-matters" class="slide level2">
<h2>Learning Rate Matters</h2>

<img data-src="../assets/learning_rate_matters.png" class="quarto-figure quarto-figure-center r-stretch"><aside class="notes">
<ul>
<li><strong>Tiny learning rate:</strong> tiny steps, takes forever</li>
<li><strong>Good learning rate:</strong> steady progress to the bottom</li>
<li><strong>Huge learning rate:</strong> giant leaps, overshoots minima</li>
</ul>
<p>So if your gradient, for example, is 0.5 and the learning rate is 0.01, the learning rate will scale down any updates. And here’s why this matters: in this case, a tiny learning rate has tiny steps. It will take forever to reach the bottom. A good learning rate has steady progress all the way to the bottom. A huge learning rate has these giant leaps that can bounce back and forth, overshooting the minima.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="adam-optimizer" class="slide level2">
<h2>Adam Optimizer</h2>
<p><strong>Adapts learning rate for each weight individually</strong></p>
<p><strong>Like having an assistant:</strong></p>
<ul>
<li>Knows which weights need big adjustments</li>
<li>Knows which need fine-tuning</li>
</ul>
<p><strong>Popular first choice:</strong> reliable, flexible, often faster</p>

<img data-src="../assets/optimizers_loss_curves.png" class="r-stretch quarto-figure-center"><p class="caption">Optimizers’ loss curves</p><aside class="notes">
<p>So SGD can work great, but there are smarter optimizers that can adapt to each weight individually. And one of those is Adam. It’s kind of like having an assistant that knows which weights need big adjustments and which ones need fine-tuning.</p>
<p>Adam has become a popular first choice optimizer because it’s reliable, flexible, and often faster than the alternatives. But a word of caution: don’t copy the learning rate from SGD when using Adam because your loss might explode. It’s tuned completely differently.</p>
<p>There are other optimizers in PyTorch like RMSprop, AdaGrad, and a whole lot more. And if you’re curious, check out the resources. But for most projects, SGD and Adam have you covered.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="why-zero_grad" class="slide level2">
<h2>Why <code>zero_grad()</code>?</h2>
<p><strong>Every <code>backward()</code> call adds to existing gradients</strong></p>
<p><strong>Without <code>zero_grad()</code>:</strong> gradients accumulate incorrectly</p>
<p><strong>Result:</strong> training breaks</p>
<aside class="notes">
<p>Now that you understand gradients as diagnostic scores for each parameter, <code>zero_grad</code> begins to make a lot more sense. Every time you call backward, PyTorch adds new gradients to whatever is already there. So if you don’t call <code>zero_grad</code>, you’re not just diagnosing parameters for this batch - you’re actually accumulating the diagnoses from every batch. And the gradients will keep accumulating incorrectly until your training breaks.</p>
<p>So that’s why you call <code>optimizer.zero_grad()</code> at the start of every training loop. Now you might wonder: well, why does PyTorch accumulate the gradients in the first place? It turns out that this behavior is really useful for advanced use cases like gradient accumulation or certain custom training schedules. But for most projects, including everything you’ll do in this course, you’re going to want to clear those gradients every time.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="complete-training-loop" class="slide level2">
<h2>Complete Training Loop</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="cf">for</span> batch <span class="kw">in</span> dataloader:</span>
<span id="cb1-2"><a></a>    optimizer.zero_grad()      <span class="co"># Clear gradients</span></span>
<span id="cb1-3"><a></a>    outputs <span class="op">=</span> model(inputs)     <span class="co"># Forward pass</span></span>
<span id="cb1-4"><a></a>    loss <span class="op">=</span> loss_fn(outputs, targets)  <span class="co"># Measure</span></span>
<span id="cb1-5"><a></a>    loss.backward()            <span class="co"># Diagnose</span></span>
<span id="cb1-6"><a></a>    optimizer.step()           <span class="co"># Update</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Measure → Diagnose → Update</strong></p>
<aside class="notes">
<p>You can now understand the complete training loop. Loss functions measure how wrong or how right the model is. Backward diagnoses how each parameter contributes to the errors. Optimizers then use those diagnostic scores to update the weights.</p>
<p>Now before you start building your first classifier, I have one final PyTorch-specific topic to discuss, and that’s device management. And that means making your code run on GPUs for faster training. And I’ll see you there.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="whats-next" class="slide level2">
<h2>What’s Next?</h2>
<p>In <a href="../../W4_DL/C1_M2_PyTorch_Workflow/session3.html"><strong>Session 3: Device Management and Image Classification Setup</strong></a>, you learn:</p>
<ul>
<li>Running on GPUs vs CPUs</li>
<li>Moving models and data to devices</li>
<li>Setting up MNIST data pipeline</li>
<li>Building your first image classifier architecture</li>
</ul>
<aside class="notes">
<p>In the next session, we’ll learn about device management - how to make your code run on GPUs for much faster training. Then we’ll set up the complete data pipeline for MNIST and build the architecture for your first image classifier.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../assets/icon.svg" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"},{"title":"Index","icon":"<svg width='1.8rem' viewBox='0 0 24 24'><path d='M5 7h14M5 12h14M5 17h7' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/></svg>","src":"../index.html"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>