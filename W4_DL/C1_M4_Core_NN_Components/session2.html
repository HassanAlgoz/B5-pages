<!DOCTYPE html>
<html lang="en"><head>
<link href="../../assets/icon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.26">

  <meta name="author" content="malfadly@sdaia.gov.sa">
  <title>AI Pros Bootcamp – Module 4 - Session 2: PyTorch Techniques and Model Inspection</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-2476b6dbe24137c74cb80772f2f63bf0.css">
  <link rel="stylesheet" href="../../assets/sdaia.scss">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="icon" href="../../assets/icon.svg">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../../assets/anim.svg" data-background-opacity="0.1" class="quarto-title-block center">
  <h1 class="title">Module 4 - Session 2: PyTorch Techniques and Model Inspection</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="session-2-pytorch-techniques-and-model-inspection" class="slide level2">
<h2>Session 2: PyTorch Techniques and Model Inspection</h2>
<p><strong>What you’ll know by the end:</strong></p>
<ul>
<li>How PyTorch’s dynamic computation graphs work</li>
<li>When to use Sequential vs.&nbsp;custom modules</li>
<li>How to build modular, reusable architectures</li>
<li>Tools for inspecting and debugging models</li>
</ul>
<aside class="notes">
<p>Welcome back. You’ve just trained your first convolutional neural network for the Botanical Garden app. But let’s take a closer look. The structure is completely linear. Data flows straight through. There’s three blocks of convolution, ReLU, and pooling layers. And then it’s flattened and passed through a few more layers before outputting a prediction.</p>
<p>Now that’s a solid start, but so far it’s just a stack of layers. It looks repetitive and it doesn’t really show off what makes PyTorch special. In PyTorch, you’re not locked into that rigid model structure. And it accomplishes this using something called a dynamic computation graph that gets built as your model runs step by step.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dynamic-computation-graphs" class="slide level2">
<h2>Dynamic Computation Graphs</h2>
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="./assets/pt_dynamic_computation_graph.jpg" class="quarto-figure quarto-figure-center"></p>
</figure>
</div>
</div><div class="column" style="width:70%;">
<p><strong>What makes PyTorch special</strong></p>
<ul>
<li>Graph built on-the-fly as your model runs</li>
<li>Every operation recorded step-by-step</li>
<li>Used for backpropagation, then discarded</li>
</ul>
</div><aside class="notes">
<p>In PyTorch, you’re not locked into that rigid model structure. And it accomplishes this using something called a dynamic computation graph that gets built as your model runs step by step. As you heard way back in Module 1, older frameworks worked differently. You had to define your computation graphs ahead of time before any data could pass through.</p>
<p>But what does that actually mean? What is a computation graph? When you write a sequential block, you’re defining a specific mathematical equation. Conv2d might specify thousands of multiplications and additions. ReLU zeros out any negative values, and when chained together, you get one giant equation. Now imagine spelling out that very equation every single calculation one step at a time. Multiply this by that, add the results of this, zero out negatives, multiply again, add the bias, on and on and on countless times. That step-by-step breakdown? That’s a computation graph. Every operation you apply is recorded as part of that graph.</p>
<p>Why? Because during training, all deep learning frameworks need to walk backwards through the graph using the chain rule from calculus. That’s how it figures out how to adjust each and every parameter.</p>
<p>And older frameworks handled this differently than PyTorch does now. You had to define that entire graph up front, every operation, every connection, before anything could run. Once defined, the structure was locked.</p>
<p>And that’s exactly what PyTorch set out to change. Let’s look at an example. Imagine you’re building a CNN for your botanical garden app, but now you want it to handle flowers differently from butterflies. In PyTorch, you can write that logic directly inside the forward method. In older frameworks with static graphs, that kind of control was really, really difficult. Yes, they allowed you to have the conditionals, but only by building every possible path ahead of time.</p>
<p>PyTorch takes a different approach. That if statement doesn’t just control the logic, it shapes the graph itself. Each time forward runs, PyTorch records exactly what happens. Every multiplication, addition, layer, and branch. The result is a custom computation graph built on the fly, based on the actual path that your data takes. That graph is used for back propagation, so the parameters get updated, and then the graph is discarded. Next time forward runs, PyTorch starts from scratch, building a brand new graph tailored for that run, even if it follows a completely different path.</p>
<p>And that’s the core difference. Static frameworks make you think like a compiler, but PyTorch lets you think like a Python programmer. Write logic, branch, adapt on the fly. This flexibility comes from using nn.Module instead of nn.Sequential, where the init defines our model, and forward allows us to define the flow of your dynamic graph.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="why-dynamic-graphs-matter" class="slide level2">
<h2>Why Dynamic Graphs Matter</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb1-2"><a></a>    <span class="cf">if</span> x.shape[<span class="dv">0</span>] <span class="op">&gt;</span> <span class="dv">100</span>:</span>
<span id="cb1-3"><a></a>        <span class="co"># Complex path</span></span>
<span id="cb1-4"><a></a>    <span class="cf">else</span>:</span>
<span id="cb1-5"><a></a>        <span class="co"># Simple path</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Real-world benefits</strong></p>
<ul>
<li>Adaptive models (simpler for simple cases, complex for tricky ones)</li>
<li>Standard Python debugging (just add a print)</li>
<li>Variable input sizes (sentences: 3 words vs.&nbsp;50 words)</li>
<li>Small performance cost, huge flexibility gains</li>
</ul>
<aside class="notes">
<p>Now, these dynamic graphs do come with a small performance trade-off. But for researchers and developers, that flexibility means faster iteration, easier debugging, and more expressive models. And it’s not just a nice idea, it solves real problems that you will actually run into.</p>
<p>For example, static graphs often require all inputs to be the same shape. But what if you’re working with sentences, where some have three words and some really long ones have 50? In PyTorch, it just works.</p>
<p>If you need to debug something in the middle of a computation, in static frameworks that meant switching to a special debug mode. Interrupting the flow wasn’t allowed. In PyTorch, it’s just Python. If you need to investigate an issue, just add a print. You can even build models that adapt to the input, like running a simpler model for simple cases and a complex model for trickier cases.</p>
<p>Your model becomes smart about its own computation. And these are not edge cases. This is how modern AI works. In PyTorch, it’s all possible by just writing Python code.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="use-nn.sequential-for-fixed-patterns" class="slide level2">
<h2>Use <code>nn.Sequential</code> for fixed patterns</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, in_channels):</span>
<span id="cb2-2"><a></a>        <span class="co"># ...</span></span>
<span id="cb2-3"><a></a>        <span class="va">self</span>.features <span class="op">=</span> nn.Sequential(</span>
<span id="cb2-4"><a></a>            ConvBlock(in_channels, <span class="dv">32</span>),</span>
<span id="cb2-5"><a></a>            ConvBlock(<span class="dv">32</span>, <span class="dv">64</span>),</span>
<span id="cb2-6"><a></a>            ConvBlock(<span class="dv">64</span>, <span class="dv">128</span>),</span>
<span id="cb2-7"><a></a>            <span class="co"># ...</span></span>
<span id="cb2-8"><a></a>        )</span>
<span id="cb2-9"><a></a>        <span class="va">self</span>.classifier <span class="op">=</span> nn.Sequential(</span>
<span id="cb2-10"><a></a>            <span class="co"># ...</span></span>
<span id="cb2-11"><a></a>        )</span>
<span id="cb2-12"><a></a></span>
<span id="cb2-13"><a></a>    <span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb2-14"><a></a>        x <span class="op">=</span> <span class="va">self</span>.features(x)</span>
<span id="cb2-15"><a></a>        x <span class="op">=</span> <span class="va">self</span>.classifier(x)</span>
<span id="cb2-16"><a></a>        <span class="cf">return</span> x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<aside class="notes">
<p>PyTorch’s nn-sequential to group layers that run in order. Now in the forward, that’s it. You want to add that fourth block your client just asked for? Well now you can just update init. No forward method change is needed. No naming conflicts. No forgotten layers. You define the sequence once and sequential handles the execution.</p>
<p>Look at that forward method. Two lines for the sequential blocks instead of 15.</p>
<p>Why should you even bother with two methods? Well, there’s a good reason as it separates concerns as was suggested by the previous video. The init method is there to define your model’s architecture, the layers and their learnable parameters that will persist across training. These will be the actual values that your model is learning. While the forward method, in a sense, is defining the dynamic flow of your computation graph. And it’s this separation that enables PyTorch’s flexibility.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="use-nn.module-for-reusable-blocks" class="slide level2">
<h2>Use <code>nn.Module</code> for reusable blocks</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a><span class="kw">class</span> ConvBlock(nn.Module):</span>
<span id="cb3-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, in_channels, out_channels):</span>
<span id="cb3-3"><a></a>        <span class="va">self</span>.conv <span class="op">=</span> nn.Conv2d(...)</span>
<span id="cb3-4"><a></a>        <span class="va">self</span>.relu <span class="op">=</span> nn.ReLU()</span>
<span id="cb3-5"><a></a>        <span class="va">self</span>.pool <span class="op">=</span> nn.MaxPool2d(...)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Workflow: Start explicit, then refactor</strong></p>
<aside class="notes">
<p>Since you’re repeating that same pattern, you can group those layers into a single block. It keeps things cleaner and easier to reuse. This is now a reusable building block, just like any built-in PyTorch layer.</p>
<p>Now look how clean your CNN becomes. Adding that fourth block? Well just add a new conv block to features. Want to change all blocks to use batch normalization? Update conv block once and all three blocks will get the change. This is modularity. Building complex models from simpler reusable parts.</p>
<p>You can even nest modules inside modules to create clean scalable architectures.</p>
<p>So here’s a quick workflow tip. Start explicit, then refactor. And when building something new, write everything out even if it’s repetitive. It makes debugging easier and helps you see exactly what’s happening. Once it works, look for patterns.</p>
<p>Other repeated sequences? Well use sequential. Other reusable blocks? Create custom modules like conv block. Think of it as a rough draft that you polish as you go along. You’re not writing redundant code because you don’t know better. You’re doing it to understand and debug effectively.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="inspecting-your-model" class="slide level2 smaller">
<h2>Inspecting Your Model</h2>
<p><strong>Basic inspection</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a><span class="co"># Structure overview</span></span>
<span id="cb4-2"><a></a><span class="bu">print</span>(model)</span>
<span id="cb4-3"><a></a></span>
<span id="cb4-4"><a></a><span class="co"># Counting and locating parameters</span></span>
<span id="cb4-5"><a></a>total <span class="op">=</span> <span class="bu">sum</span>(p.numel() <span class="cf">for</span> p <span class="kw">in</span> model.parameters())</span>
<span id="cb4-6"><a></a></span>
<span id="cb4-7"><a></a><span class="co"># Per layer (shows where each set lives)</span></span>
<span id="cb4-8"><a></a><span class="cf">for</span> name, param <span class="kw">in</span> model.named_parameters():</span>
<span id="cb4-9"><a></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>param<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>Inspecting nested blocks</strong></p>
<ul>
<li><code>model.children()</code>: top-level only</li>
<li><code>model.modules()</code>: everything, including nested (think folder structure)</li>
</ul>
<p>Note: the shape for, say, <code>fc1.weight</code> connecting 2,048 inputs to 512 outputs is reversed: <code>(512, 2048)</code> because each row = weights for one output neuron.</p>
<aside class="notes">
<p>Welcome back. You’ve learned how to train a convolutional neural network layer by layer with a solid data pipeline and tools to boost performance. Now it’s time for one last skill, inspecting what’s inside your model. In this video, you’ll explore tools to examine your model structure, count its parameters, and understand how layers are wired together. You’ll also see how this helps you solve real issues like those pesky shape mismatch errors.</p>
<p>Let’s start with a simple question. How do you see what’s inside your model? Your first instinct might be to print it. And you’ll get something like this. Each line shows you the name that you gave the layer, like conv1 or fc2, the type of layer, such as conv2d, maxpool2d, or dropout, and key settings like input and output sizes or kernel size. This mirrors exactly what you defined in init. It’s like PyTorch is showing you a blueprint, perfect for spotting those structural mistakes.</p>
<p>But notice what’s missing. How many parameters does each layer have? What shapes are the tensors? What’s actually inside those sequential blocks? In this video, you’ll learn how to dig deeper.</p>
<p>So let’s start with that first question. How many parameters does your model have? To count parameters, you might try, but instead of a list, you’ll get something like this. That’s a generator. Can you think of a reason why PyTorch might use generators here? Because it’s efficient. It doesn’t load everything into memory. It just gives you one parameter at a time when they’re needed.</p>
<p>To actually see the parameters, you’ll need to iterate, and you’ll get shapes like this. Each shape represents a set of parameters, usually weights and biases from your layers.</p>
<p>But if you want the total number of parameters, here’s the standard approach. The .numL method gives you the number of elements in each tensor. Add them all up, and you’ve got your total parameter count. Over a million parameters, well, great, but where exactly are they?</p>
<p>To find out, you need to look at each layer individually, and that’s where .namedParameters comes in. This shows you exactly where each set of weights and biases live, layer by layer.</p>
<p>To understand these shapes, let’s take a look at fc1.weight as an example. It connects 2,048 inputs to 512 outputs, so you get a weight matrix with a shape 512 by 2,048. Each row holds the weights for one output neuron, one weight for every input. Now, that might feel backwards if you’re expecting it in the order of input-output, but the shape reflects the purpose. Each output combines information from all inputs. So PyTorch organizes the weights around the outputs. And the bias, well, that’s the 512. There’s one value per output neuron.</p>
<p>But what if your model includes nested blocks like sequential or custom modules? How do you peek inside them? Well, PyTorch gives you two handy methods, children and modules. Let’s start with children. This shows only the top-level components, like your convolutional or your fully-connected layers. If a block contains other layers like sequential or a custom module, you won’t see what’s inside.</p>
<p>To go deeper, try modules. What’s the difference? Think of your model like a folder structure. Children shows only the top-level folders. Modules shows everything inside, including layers nested inside sequential or other custom blocks. This is especially helpful when you’re working with modular architectures and you’ll want to inspect every layer.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="debugging-shape-mismatches" class="slide level2 smaller">
<h2>Debugging Shape Mismatches</h2>
<p><strong>Common error: “mat1 and mat2 shapes cannot be multiplied”</strong></p>
<p><strong>Two-step approach:</strong></p>
<ol type="1">
<li><strong>Check layer shape:</strong> <code>print(model.fc1.weight.shape)</code> - what does FC1 expect?</li>
<li><strong>Trace shapes through forward:</strong> Print shapes at each step to see what it actually gets</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a><span class="kw">def</span> forward(<span class="va">self</span>, x):</span>
<span id="cb5-2"><a></a>    <span class="bu">print</span>(<span class="ss">f"After features: </span><span class="sc">{</span>x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-3"><a></a>    x <span class="op">=</span> x.flatten()</span>
<span id="cb5-4"><a></a>    <span class="bu">print</span>(<span class="ss">f"After flatten: </span><span class="sc">{</span>x<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-5"><a></a>    <span class="co"># ...</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Combine inspection (what layer expects) with shape tracing (what it gets) to quickly pinpoint the issue.</p>
<aside class="notes">
<p>Now, you’ve got the full picture of your model, but what happens when something goes wrong? Well, let’s take a look at a common PyTorch error. This one usually means the input to a linear layer did not match what the layer expected. In real projects, the first thing most people check is the shape of the layer itself.</p>
<p>If the error happens at FC1, you can print its weight shape like this, and that gives you the fastest answer. But if you’re not sure which layer is causing the issue or you want to inspect multiple layers at once, you can just use named parameters.</p>
<p>So FC1 expects 1024 inputs, but your model’s passing in 2048. Why the mismatch? To trace the shape through your model, try printing it inside the forward pass. Now you can see the shape that your features block is producing and whether flattening is working as expected.</p>
<p>By combining model inspection, what FC1 expects, with shape tracing, what it actually gets, you can quickly pinpoint where things went off track. That’s how inspection and debugging work together.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="module-4-synthesis" class="slide level2">
<h2>Module 4 Synthesis</h2>
<p><strong>From single neuron to CNN</strong></p>
<ul>
<li>Started: predicting delivery times</li>
<li>Now: convolutional neural networks</li>
<li>Built data pipelines, trained and evaluated models, inspected what’s happening</li>
</ul>
<aside class="notes">
<p>And with that, you’ve reached the end of this video and the end of course one. From a single neuron predicting delivery times to a convolutional neural network, you’ve come a long way. You’ve built a solid foundation in PyTorch, creating data pipelines, building and training models, evaluating performance, and inspecting what’s happening under the hood.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="lab-2-model-debugging-inspection-and-modularization" class="slide level2">
<h2>Lab 2: Model Debugging, Inspection, and Modularization</h2>
<blockquote>
<p>“Debugging is twice as hard as writing the code in the first place. Therefore, if you write the code as cleverly as possible, you are, by definition, not smart enough to debug it.” — Brian Kernighan</p>
</blockquote>
<center>
CUE: START THE LAB HERE
</center>
</section>
<section id="assignment-1-overcoming-overfitting-building-a-robust-cnn" class="slide level2">
<h2>Assignment 1: Overcoming Overfitting: Building a Robust CNN</h2>
<center>
CUE: START THE ASSIGNMENT HERE
</center>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../assets/icon.svg" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"},{"title":"Index","icon":"<svg width='1.8rem' viewBox='0 0 24 24'><path d='M5 7h14M5 12h14M5 17h7' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/></svg>","src":"../index.html"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>